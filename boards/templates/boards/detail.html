{% extends 'base.html' %} 

{% block content %}
  <h1>DETAIL</h1>
  작성자 : {{ article.user }}<br>
  글 제목 : {{article.title}} | 조회수 : {{ article.reads}}<br>
  작성 시간 : {{article.created_at}}
  <hr>
  <p>글 내용 : {{article.content}}</p>
  {% if article.image %}
  <img src="{{article.image.url}}" alt="{{article.image}}" style="width: 600px;">
  {% endif %}
  <hr>
  <a href="{% url 'boards:index' %}" class="btn btn-success">글 목록</a>
  {% if article.user == request.user %}
  <form action="{% url 'boards:delete' article.pk %}" class="btn btn-danger" method="POST">삭제하기</form>
  {% endif %}
  
  <!-- 좋아요 -->
  {% if request.user in article.like_users.all %}
  <a href="{% url 'boards:like' article.pk %}">
  <i class="fas fa-heart fa-lg animated hinge delay-1s" style="color: red;">취소하기</i></a>
  
  {% else %}
  <a href="{% url 'boards:like' article.pk %}">
    <i class="far fa-heart fa-lg animated infinite bounce delay-1s" style="color: gray;">좋아요</i>
</a>
  {% endif %}
  <p>{{ article.like_users.count }}명이 좋아합니다. </p>
  <hr>

<!--이하 댓글창-->

<h4>댓글 목록</h4>

<!--read-->
{% if comments %}
  <p><b>{{ comments|length }}개의 댓글이 있습니다.</b></p>
{% endif %}
<ul>
  {% for comment in comment_view %}
  <hr>
  <p>{{ comment.user }}</p>
  <p>{{ comment.content }}</p>
  <!--delete-->
  {% if user == comment.user %}
  <form action="{% url 'boards:comments_delete' article.pk comment.pk %}" method="POST" class="d-inline">
    {% csrf_token %}
    <input type="submit" value="DELETE">
  </form>
{% endif %}
  <hr>
  {% endfor %}
</ul>

<hr>

<!--create-->
{% if request.user.is_authenticated %}
    <p>로그인됨</p>

  <form action="{% url 'boards:comments_create' article.pk %}" method="POST">
    {% csrf_token %}
    {{ comment_form }}
    <input type="submit">
  </form>
{% else %}
  <a href="{% url 'accounts:login' %}">[댓글을 작성하려면 로그인하세요.]</a>
{% endif %}

<!--이상 댓글창-->
{% endblock content %}